{% extends 'inventory/base.html' %}
{% block content %}
{% if messages %}
<div class="row mt-3">
  {% for message in messages %}
  <div class="col-md-10 col-12 mx-auto alert alert-{{ message.tags }}">
    {{ message }}
  </div>
  {% endfor %}
</div>
{% endif %}
<div class="row">
  <div class="col-md-10 col-12 mx-auto mt-5">
    <div class="d-flex justify-content-between mb-3">
      <form method="GET" action="{% url 'dashboard' %}" class="form-inline">
        <input type="text" name="search" placeholder="Search items..." class="form-control me-2" value="{{ request.GET.search|default_if_none:'' }}">
        <button type="submit" class="btn btn-secondary">Search</button>
      </form>
      <a href="{% url 'add-item' %}" class="btn btn-primary">Add New Item</a>
    </div>
    <table class="table table-hover table-striped">
      <thead>
        <tr>
          <th scope="col"><a href="?sort=id&order={{ next_sort_order }}">ID</a></th>
          <th scope="col"><a href="?sort=pc_name&order={{ next_sort_order }}">PC Name</a></th>
          <!-- Removed quantity sort link since the field does not exist -->
          <th scope="col"><a href="?sort=category&order={{ next_sort_order }}">Category</a></th>
          <th scope="col"><a href="?sort=barcode&order={{ next_sort_order }}">Barcode</a></th>
          <th scope="col"><a href="?sort=location&order={{ next_sort_order }}">Location</a></th>
          <th scope="col"><a href="?sort=supplier&order={{ next_sort_order }}">Supplier</a></th>
          <th scope="col"><a href="?sort=notes&order={{ next_sort_order }}">Notes</a></th>
          <th scope="col">Actions</th>
        </tr>
    </thead>
    <tbody>
        {% if items|length == 0 %}
        <tr>
          <td colspan="8" class="text-center">No items found.</td>
        </tr>
        {% else %}
        {% for item in items %}
        <tr>
            <th scope="row">{{ item.id }}</th>
            <td>{{ item.pc_name }}</td>
            <!-- Removed cell for quantity -->
            <td>
              {% if item.category %}
                  {{ item.category.name }}
              {% else %}
                  None
              {% endif %}
            </td>
            <td>
              {% if item.location %}
                  {{ item.location.location }}
              {% else %}
                  None
              {% endif %}
            </td>
            <td>
              {% if item.supplier %}
                  {{ item.supplier.name }}
              {% else %}
                  None
              {% endif %}
            </td>
            <td> 
              {% if item.notes %}
              {{ item.notes }}
              
            </td>
            <td>
              {{ Actions }}
            </td>
            <td>
                <a href="{% url 'edit-item' item.id %}" class="btn btn-outline-secondary btn-sm">Edit</a>
                <a href="{% url 'delete-item' item.id %}" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this item?');">Delete</a>
                <a href="{% url 'checkout_item' item.id %}" class="btn btn-info btn-sm">Check Out</a>
            </td>
        </tr>
        {% endfor %}
        {% endif %}
    </tbody>    
    <!-- Pagination could go here if needed -->
  </div>
</div>
{% endblock content %}
