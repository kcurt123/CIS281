{% extends 'inventory/base.html' %}
{% block content %}
{% if messages %}
<div class="row mt-3">
  {% for message in messages %}
  <div class="col-md-10 col-12 mx-auto alert alert-{{ message.tags }}">
    {{ message }}
  </div>
  {% endfor %}
</div>
{% endif %}
<div class="row">
  <div class="col-md-10 col-12 mx-auto mt-5">
    <div class="d-flex justify-content-end mb-3">
      <form method="GET" action="{% url 'dashboard' %}" class="me-2">
        <input type="text" name="search" placeholder="Search items..." value="{{ search_query }}">
        <button type="submit" class="btn btn-secondary">Search</button>
      </form>
      <a href="{% url 'add-item' %}" class="btn btn-primary">+</a>
    </div>
    <table class="table table-hover table-striped">
      <thead>
        <tr>
          <th scope="col"><a href="?sort=id&order={{ next_sort_order }}">ID</a></th>
          <th scope="col"><a href="?sort=pc_name&order={{ next_sort_order }}">PC Name</a></th>
          <th scope="col"><a href="?sort=department&order={{ next_sort_order }}">Department</a></th>
          <th scope="col"><a href="?sort=model_number&order={{ next_sort_order }}">Model Number</a></th>
          <th scope="col"><a href="?sort=serial_number&order={{ next_sort_order }}">Serial Number</a></th>
          <th scope="col"><a href="?sort=notes&order={{ next_sort_order }}">Notes</a></th>
          <th scope="col"><a href="{% url 'dashboard' %}?sort=supplier&order={{ next_sort_order }}">Supplier</a></th>
          <th scope="col"><a href="{% url 'dashboard' %}?sort=is_checked_out&order={{ next_sort_order }}">Status</a></th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for item in items %}
          <tr class="table-warning" {% if item.is_checked_out %} table-light {% endif %}>
            <th scope="row">{{ item.id }}</th>
            <td>{{ item.pc_name }}</td>
            <td>
              {% if item.department %}
                {{ item.department.department }}
              {% else %}
                None
              {% endif %}
            </td>
            <td>{{ item.model_number }}</td>
            <td>{{ item.serial_number }}</td>
            <td>
              {% if item.notes %}
                {{ item.notes }}
              {% else %}
                None
              {% endif %}
            </td>
            <td>
              {% if item.supplier %}
                {{ item.supplier.name }}
              {% else %}
                No Supplier
              {% endif %}
            </td>
            <td>
              {% if item.is_checked_out %}
                Checked Out
              {% else %}
                Available
              {% endif %}
            </td>
            <td>
              <a href="{% url 'edit-item' item.id %}" class="btn btn-outline-secondary btn-sm">Edit</a>
              <a href="{% url 'delete-item' item.id %}" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this item?');">Delete</a>
              {% if not item.is_checked_out %}
              <a href="{% url 'checkout_item' item.id %}" class="btn btn-info btn-sm">Check Out</a>
              {% else %}
              <a href="{% url 'return_item' item.id %}" class="btn btn-success btn-sm">Return</a>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock content %}

